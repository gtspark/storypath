<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Your Story - StoryPath</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="css/main.css?v=1763464103">
    <link rel="stylesheet" href="css/wizard.css?v=1763464103">
    <script src="https://cdn.jsdelivr.net/npm/tsparticles@3.0.0/tsparticles.bundle.min.js"></script>
    <script src="js/i18n.js?v=1763464103"></script>
</head>
<body>
    <!-- Language Selector -->
    <div class="lang-selector">
        <button class="lang-pill active" data-lang="en" onclick="switchLanguage('en')">
            EN
        </button>
        <button class="lang-pill" data-lang="ja" onclick="switchLanguage('ja')">
            Êó•Êú¨Ë™û
        </button>
    </div>

    <div class="wizard-container">
        <!-- Wizard Header -->
        <div class="wizard-header">
            <h1 class="wizard-title">‚ú® <span data-i18n="generator.wizardTitle">Create Your Adventure</span> ‚ú®</h1>
            <div class="wizard-step-indicator">
                <div class="step-dot active" data-step="1"></div>
                <div class="step-dot" data-step="2"></div>
                <div class="step-dot" data-step="3"></div>
                <div class="step-dot" data-step="4"></div>
                <div class="step-dot" data-step="5"></div>
            </div>
        </div>

        <!-- Step 1: Genre Selection -->
        <div class="wizard-step" id="step1">
            <h2 data-i18n="generator.step1Title">What kind of story calls to you?</h2>

            <div class="genre-grid">
                <div class="genre-card" data-genre="fantasy" onclick="selectGenre('fantasy')">
                    <div class="genre-icon">üè∞</div>
                    <h3 data-i18n="generator.genres.fantasy">Fantasy</h3>
                    <p data-i18n="generator.genreDescs.fantasy">Dragons, magic, and epic quests!</p>
                    <div class="genre-sparkle">‚ú®</div>
                </div>

                <div class="genre-card" data-genre="scifi" onclick="selectGenre('scifi')">
                    <div class="genre-icon">üöÄ</div>
                    <h3 data-i18n="generator.genres.scifi">Sci-Fi</h3>
                    <p data-i18n="generator.genreDescs.scifi">Space adventures and future tech!</p>
                    <div class="genre-sparkle">‚≠ê</div>
                </div>

                <div class="genre-card" data-genre="mystery" onclick="selectGenre('mystery')">
                    <div class="genre-icon">üîç</div>
                    <h3 data-i18n="generator.genres.mystery">Mystery</h3>
                    <p data-i18n="generator.genreDescs.mystery">Solve puzzles and uncover secrets!</p>
                    <div class="genre-sparkle">üåü</div>
                </div>

                <div class="genre-card" data-genre="adventure" onclick="selectGenre('adventure')">
                    <div class="genre-icon">üó∫Ô∏è</div>
                    <h3 data-i18n="generator.genres.adventure">Adventure</h3>
                    <p data-i18n="generator.genreDescs.adventure">Explore worlds and discover treasures!</p>
                    <div class="genre-sparkle">üí´</div>
                </div>

                <div class="genre-card" data-genre="horror" onclick="selectGenre('horror')">
                    <div class="genre-icon">üëª</div>
                    <h3 data-i18n="generator.genres.horror">Spooky</h3>
                    <p data-i18n="generator.genreDescs.horror">Spooky (but not too scary!) mysteries!</p>
                    <div class="genre-sparkle">üéÉ</div>
                </div>
            </div>

            <div class="wizard-nav">
                <button class="btn" onclick="goHome()">
                    <span data-i18n="generator.back">Back</span>
                </button>
                <button class="btn btn-primary" onclick="nextStep()" disabled id="step1Next">
                    <span data-i18n="generator.next">Next</span>
                </button>
            </div>
        </div>

        <!-- Step 2: Difficulty -->
        <div class="wizard-step hidden" id="step2">
            <h2 data-i18n="generator.step2Title">How challenging should your journey be?</h2>

            <div class="radio-group">
                <div class="radio-option" onclick="selectDifficulty('casual', event)">
                    <input type="radio" name="difficulty" value="casual" style="pointer-events: none;">
                    <span class="radio-label">
                        ‚òÄÔ∏è <span data-i18n="generator.difficulty.casual">Casual</span>
                    </span>
                    <div class="radio-desc" data-i18n="generator.difficultyDescs.casual">
                        Story-focused, minimal failure
                    </div>
                </div>

                <div class="radio-option" onclick="selectDifficulty('balanced', event)">
                    <input type="radio" name="difficulty" value="balanced" checked style="pointer-events: none;">
                    <span class="radio-label">
                        ‚öñÔ∏è <span data-i18n="generator.difficulty.balanced">Balanced</span>
                    </span>
                    <div class="radio-desc" data-i18n="generator.difficultyDescs.balanced">
                        Choices matter, some risk
                    </div>
                </div>

                <div class="radio-option" onclick="selectDifficulty('hardcore', event)">
                    <input type="radio" name="difficulty" value="hardcore" style="pointer-events: none;">
                    <span class="radio-label">
                        ‚öîÔ∏è <span data-i18n="generator.difficulty.hardcore">Hardcore</span>
                    </span>
                    <div class="radio-desc" data-i18n="generator.difficultyDescs.hardcore">
                        High stakes, permadeath!
                    </div>
                </div>
            </div>

            <h2 data-i18n="generator.maturityTitle" style="margin-top: 30px;">Who is this story for?</h2>

            <div class="radio-group">
                <div class="radio-option selected" onclick="selectMaturity('kids', event)">
                    <input type="radio" name="maturity" value="kids" checked style="pointer-events: none;">
                    <span class="radio-label">
                        üßí <span data-i18n="generator.maturity.kids">For Kids</span>
                    </span>
                    <div class="radio-desc" data-i18n="generator.maturityDescs.kids">
                        Safe and fun, setbacks are minor
                    </div>
                </div>

                <div class="radio-option" onclick="selectMaturity('adult', event)">
                    <input type="radio" name="maturity" value="adult" style="pointer-events: none;">
                    <span class="radio-label">
                        üíÄ <span data-i18n="generator.maturity.adults">For Adults</span>
                    </span>
                    <div class="radio-desc" data-i18n="generator.maturityDescs.adults">
                        Real consequences - you can die and get game over
                    </div>
                </div>
            </div>

            <div class="wizard-nav">
                <button class="btn" onclick="prevStep()">
                    <span data-i18n="generator.back">Back</span>
                </button>
                <button class="btn btn-primary" onclick="nextStep()">
                    <span data-i18n="generator.next">Next</span>
                </button>
            </div>
        </div>

        <!-- Step 3: Character Setup -->
        <div class="wizard-step hidden" id="step3">
            <h2 data-i18n="generator.step3Title">Who are you in this tale?</h2>

            <div class="form-group">
                <label data-i18n="generator.name">Name</label>
                <input type="text" id="protagonistName" placeholder="">
                <p class="form-note" data-i18n="generator.namePlaceholder">Leave blank for AI to choose</p>
            </div>

            <div class="form-group">
                <label>
                    <span data-i18n="generator.gender">Gender</span>
                    <span class="tooltip-icon" title="For kids' stories: Male protagonists get action-focused visuals (robots, spaceships, vehicles). This can be overridden with a custom story idea below.">‚ìò</span>
                </label>
                <select id="protagonistGender">
                    <option value="male" data-i18n="generator.genderOptions.male">Male</option>
                    <option value="female" data-i18n="generator.genderOptions.female">Female</option>
                    <option value="nonbinary" data-i18n="generator.genderOptions.nonbinary">Non-binary</option>
                    <option value="other" data-i18n="generator.genderOptions.other">Other</option>
                </select>
            </div>

            <div class="form-group">
                <label data-i18n="generator.archetype">Archetype</label>
                <select id="protagonistArchetype">
                    <!-- Options will be populated based on genre -->
                </select>
            </div>

            <div class="form-group">
                <label data-i18n="generator.storySeed">Custom Story Idea (Optional)</label>
                <textarea id="storySeed" placeholder=""></textarea>
                <p class="form-note" data-i18n="generator.storySeedPlaceholder">Example: A detective in 1920s Chicago...</p>
            </div>

            <div class="wizard-nav">
                <button class="btn" onclick="prevStep()">
                    <span data-i18n="generator.back">Back</span>
                </button>
                <button class="btn btn-primary" onclick="nextStep()">
                    <span data-i18n="generator.next">Next</span>
                </button>
            </div>
        </div>

        <!-- Step 4: Language Selection -->
        <div class="wizard-step hidden" id="step4">
            <h2 data-i18n="generator.step4Title">Language for this story</h2>

            <div class="radio-group" id="languageOptions">
                <!-- Language options will be populated based on UI language -->
            </div>

            <p class="form-note" data-i18n="generator.languageNote">
                Once selected, this story continues in this language
            </p>

            <div class="wizard-nav">
                <button class="btn" onclick="prevStep()">
                    <span data-i18n="generator.back">Back</span>
                </button>
                <button class="btn btn-primary" onclick="nextStep()">
                    <span data-i18n="generator.next">Next</span>
                </button>
            </div>
        </div>

        <!-- Step 5: Password Protection -->
        <div class="wizard-step hidden" id="step5">
            <h2 data-i18n="generator.step5Title">Protect your story</h2>

            <div class="checkbox-group">
                <input type="checkbox" id="enablePassword" onchange="togglePasswordField()">
                <label for="enablePassword" data-i18n="generator.passwordOptional">
                    Password protect this story?
                </label>
            </div>

            <div class="form-group hidden" id="passwordFields">
                <label data-i18n="generator.passwordPlaceholder">Password</label>
                <input type="password" id="storyPassword" data-i18n-placeholder="generator.passwordPlaceholder" placeholder="Enter password">
                <p class="form-note" data-i18n="generator.passwordNote">
                    You'll need this password to continue later
                </p>
            </div>

            <div class="wizard-nav">
                <button class="btn" onclick="prevStep()">
                    <span data-i18n="generator.back">Back</span>
                </button>
                <button class="btn btn-primary" onclick="createStory()">
                    <span data-i18n="generator.create">Create Story!</span>
                </button>
            </div>
        </div>

        <!-- Loading Screen -->
        <div class="wizard-step hidden" id="loadingStep">
            <div class="loading-screen">
                <!-- Particle container -->
                <div id="loadingParticles"></div>

                <!-- 3D Animated book opening -->
                <div class="book-3d">
                    <span class="page turn"></span>
                    <span class="page turn"></span>
                    <span class="page turn"></span>
                    <span class="page turn"></span>
                    <span class="page turn"></span>
                    <span class="page turn"></span>
                    <span class="cover"></span>
                    <span class="page"></span>
                    <span class="cover turn"></span>
                </div>

                <h2 class="loading-text" data-i18n="generator.generating">Weaving Your Tale...</h2>
                <p class="loading-subtitle" id="loadingSubtitle">Gathering magical ink...</p>

                <!-- Progress bar -->
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-bar-fill" id="progressBarFill"></div>
                        <div class="progress-shimmer"></div>
                    </div>
                    <div class="progress-text" id="progressText">0%</div>
                </div>

                <!-- Floating story elements -->
                <div class="story-elements">
                    <div class="story-element">üìñ</div>
                    <div class="story-element">‚ú®</div>
                    <div class="story-element">üé≠</div>
                    <div class="story-element">üé®</div>
                    <div class="story-element">‚öîÔ∏è</div>
                    <div class="story-element">üîÆ</div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/wizard.js?v=1763464103" defer></script>
</body>
</html>
