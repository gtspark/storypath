// i18n translations for StoryPath
const translations = {
    en: {
        splash: {
            title: "StoryPath",
            subtitle: "Where every choice writes your tale!",
            tagline: "Choose Your Adventure",
            newStory: "Begin a New Adventure!",
            yourStories: "Your Story Collection",
            locked: "Tap to unlock",
            scene: "Scene",
            ago: "ago"
        },
        generator: {
            wizardTitle: "Create Your Adventure",
            step1Title: "What kind of story calls to you?",
            step2Title: "How challenging should your journey be?",
            step3Title: "Who are you in this tale?",
            step4Title: "Language for this story",
            step5Title: "Protect your story",
            genres: {
                fantasy: "Fantasy",
                scifi: "Sci-Fi",
                mystery: "Mystery",
                adventure: "Adventure",
                horror: "Spooky"
            },
            genreDescs: {
                fantasy: "Dragons, magic, and epic quests!",
                scifi: "Space adventures and future tech!",
                mystery: "Solve puzzles and uncover secrets!",
                adventure: "Explore worlds and discover treasures!",
                horror: "Spooky (but not too scary!) mysteries!"
            },
            difficulty: {
                casual: "Casual",
                balanced: "Balanced",
                hardcore: "Hardcore"
            },
            difficultyDescs: {
                casual: "Story-focused, minimal failure",
                balanced: "Choices matter, some risk",
                hardcore: "High stakes, permadeath!"
            },
            maturityTitle: "Who is this story for?",
            maturity: {
                kids: "For Kids",
                adults: "For Adults"
            },
            maturityDescs: {
                kids: "Safe and fun, setbacks are minor",
                adults: "Real consequences - you can die and get game over"
            },
            name: "Name",
            namePlaceholder: "Leave blank for AI to choose",
            gender: "Gender",
            genderOptions: {
                male: "Male",
                female: "Female",
                nonbinary: "Non-binary",
                other: "Other"
            },
            archetype: "Archetype",
            archetypes: {
                warrior: "Warrior",
                mage: "Mage",
                rogue: "Rogue",
                explorer: "Explorer",
                diplomat: "Diplomat"
            },
            storySeed: "Custom Story Idea (Optional)",
            storySeedPlaceholder: "Example: A detective in 1920s Chicago...",
            languageNote: "Once selected, this story continues in this language",
            passwordOptional: "Password protect this story?",
            passwordPlaceholder: "Enter password",
            passwordNote: "You'll need this password to continue later",
            back: "Back",
            next: "Next",
            create: "Create Story!",
            skip: "Skip",
            generating: "Weaving Your Tale...",
            generatingSteps: {
                framework: "Generating story framework",
                opening: "Creating opening scene",
                character: "Preparing character",
                artwork: "Generating scene artwork"
            }
        },
        game: {
            menuBtn: "Menu",
            historyBtn: "Story So Far",
            homeBtn: "Home",
            menu: "Menu",
            save: "Save",
            history: "Story So Far",
            hp: "HP",
            inventory: "Inventory",
            karma: "Karma",
            scene: "Scene",
            chapter: "Chapter",
            loading: "Loading your story...",
            imageLoading: "Generating illustration...",
            thinking: "Weaving the next scene..."
        },
        modal: {
            passwordPrompt: "This story is password protected",
            passwordPlaceholder: "Enter password",
            unlock: "Unlock",
            cancel: "Cancel",
            invalidPassword: "Invalid password",
            close: "Close"
        }
    },
    ja: {
        splash: {
            title: "ストーリーパス",
            subtitle: "選択が物語を紡ぐ",
            tagline: "君だけの冒険へ",
            newStory: "新しい冒険を始める",
            yourStories: "保存した物語",
            locked: "パスワードで開く",
            scene: "場面",
            ago: "前"
        },
        generator: {
            wizardTitle: "物語をつくろう",
            step1Title: "どんな物語を読みたい？",
            step2Title: "難しさはどのくらい？",
            step3Title: "主人公を決めよう",
            step4Title: "言語を選ぶ",
            step5Title: "パスワードで保護する",
            genres: {
                fantasy: "ファンタジー",
                scifi: "SF",
                mystery: "ミステリー",
                adventure: "アドベンチャー",
                horror: "不気味"
            },
            genreDescs: {
                fantasy: "ドラゴン、魔法、壮大なクエスト！",
                scifi: "宇宙の冒険と未来技術！",
                mystery: "パズルを解いて秘密を明らかに！",
                adventure: "世界を探検して宝物を発見！",
                horror: "不気味だけど怖すぎないミステリー！"
            },
            difficulty: {
                casual: "やさしい",
                balanced: "ふつう",
                hardcore: "むずかしい"
            },
            difficultyDescs: {
                casual: "物語を楽しむ・失敗なし",
                balanced: "選択が大事・ときどきピンチ",
                hardcore: "油断すると死ぬ！"
            },
            maturityTitle: "誰のための物語？",
            maturity: {
                kids: "子ども向け",
                adults: "大人向け"
            },
            maturityDescs: {
                kids: "安全で楽しい・失敗しても大丈夫",
                adults: "本当に死ぬ・ゲームオーバーあり"
            },
            name: "名前",
            namePlaceholder: "空白のままにするとAIが選択",
            gender: "性別",
            genderOptions: {
                male: "男性",
                female: "女性",
                nonbinary: "ノンバイナリー",
                other: "その他"
            },
            archetype: "アーキタイプ",
            archetypes: {
                warrior: "戦士",
                mage: "魔法使い",
                rogue: "盗賊",
                explorer: "探検家",
                diplomat: "外交官"
            },
            storySeed: "カスタムストーリーアイデア（任意）",
            storySeedPlaceholder: "例：1920年代シカゴの探偵...",
            languageNote: "選択後、このストーリーはこの言語で続きます",
            passwordOptional: "このストーリーをパスワード保護しますか？",
            passwordPlaceholder: "パスワードを入力",
            passwordNote: "後で続けるにはこのパスワードが必要です",
            back: "戻る",
            next: "次へ",
            create: "ストーリーを作成！",
            skip: "スキップ",
            generating: "物語を紡いでいます...",
            generatingSteps: {
                framework: "ストーリーフレームワークを生成中",
                opening: "オープニングシーンを作成中",
                character: "キャラクターを準備中",
                artwork: "シーンアートワークを生成中"
            }
        },
        game: {
            menuBtn: "設定",
            historyBtn: "これまでの話",
            homeBtn: "ホームへ",
            menu: "メニュー",
            save: "保存",
            history: "これまでの話",
            hp: "体力",
            inventory: "持ち物",
            karma: "因果",
            scene: "場面",
            chapter: "章",
            loading: "物語を読み込み中...",
            imageLoading: "絵を生成中...",
            thinking: "次の場面を紡いでいます..."
        },
        modal: {
            passwordPrompt: "このストーリーはパスワード保護されています",
            passwordPlaceholder: "パスワードを入力",
            unlock: "ロック解除",
            cancel: "キャンセル",
            invalidPassword: "無効なパスワード",
            close: "閉じる"
        }
    }
};

// Current language
let currentLang = localStorage.getItem('storypath_lang') || 'en';

// Translation function
function t(key) {
    const keys = key.split('.');
    let value = translations[currentLang];

    for (const k of keys) {
        value = value?.[k];
    }

    return value || key;
}

// Set language
function setLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('storypath_lang', lang);

    // Update all elements with data-i18n
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        el.textContent = t(key);
    });

    // Update all elements with data-i18n-title
    document.querySelectorAll('[data-i18n-title]').forEach(el => {
        const key = el.getAttribute('data-i18n-title');
        el.setAttribute('title', t(key));
    });

    // Update HTML lang attribute
    document.documentElement.lang = lang;

    // Dispatch event
    window.dispatchEvent(new CustomEvent('languageChanged', { detail: { lang } }));
}

// Initialize on load
document.addEventListener('DOMContentLoaded', () => {
    setLanguage(currentLang);
});
